# Migration `20200419221450-initial-collaborator-setup`

This migration has been generated by Robert Westbury at 4/19/2020, 10:14:50 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_collaboratingForms" (
    "A" text  NOT NULL ,
    "B" text  NOT NULL 
) 

CREATE UNIQUE INDEX "_collaboratingForms_AB_unique" ON "public"."_collaboratingForms"("A","B")

CREATE  INDEX "_collaboratingForms_B_index" ON "public"."_collaboratingForms"("B")

ALTER TABLE "public"."_collaboratingForms" ADD FOREIGN KEY ("A")REFERENCES "public"."Form"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_collaboratingForms" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200417203155-add-custom-from-customisation..20200419221450-initial-collaborator-setup
--- datamodel.dml
+++ datamodel.dml
@@ -1,19 +1,20 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider      = "prisma-client-js"
   binaryTargets = ["native", "debian-openssl-1.1.x"]
 }
 model User {
-  id       String @default(uuid()) @id
-  email    String @unique
-  password String
-  forms    Form[]
+  id                 String @default(uuid()) @id
+  email              String @unique
+  password           String
+  forms              Form[]
+  collaboratingForms Form[] @relation("collaboratingForms", references: [id])
 }
 model Ip {
   address     String       @id
@@ -35,8 +36,9 @@
 model Form {
   id            String         @id
   ownerId       String
   owner         User           @relation(fields: [ownerId], references: [id])
+  collaborators User[]         @relation("collaboratingForms", references: [id])
   name          String
   validation    Validation?
   notifications Notifications?
   confirmation  Confirmation?
```



# Migration `20200427223033-initial-security`

This migration has been generated by Robert Westbury at 4/27/2020, 10:30:33 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Security" (
    "allowedDomains" text  NOT NULL DEFAULT '',
    "formId" text  NOT NULL ,
    "honey" text  NOT NULL DEFAULT '_honey',
    "id" SERIAL,
    "recaptchaSecret" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE UNIQUE INDEX "Security_formId" ON "public"."Security"("formId")

ALTER TABLE "public"."Security" ADD FOREIGN KEY ("formId")REFERENCES "public"."Form"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200424114410-error-appearance..20200427223033-initial-security
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider      = "prisma-client-js"
@@ -41,10 +41,20 @@
   name          String
   validation    Validation?
   confirmation  Confirmation?
   appearance    Appearance
+  security      Security
 }
+model Security {
+  id              Int    @default(autoincrement()) @id
+  formId          String
+  form            Form   @relation(fields: [formId], references: [id])
+  recaptchaSecret String @default("")
+  honey           String @default("_honey")
+  allowedDomains  String @default("")
+}
+
 model Appearance {
   id                     Int     @default(autoincrement()) @id
   formId                 String
   form                   Form    @relation(fields: [formId], references: [id])
```


